<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>画像SVG変換ツール</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>画像SVG変換ツール</h1>
            <p>JPG、PNG、GIF画像をSVG形式に変換します</p>
        </header>

        <main>
            <div class="upload-container" id="upload-container">
                <div class="upload-area" id="upload-area">
                    <p>画像をここにドラッグ&ドロップ</p>
                    <p>または</p>
                    <label for="file-input" class="upload-button">画像を選択</label>
                    <input type="file" id="file-input" accept="image/*" hidden>
                </div>
            </div>

            <div class="settings-container" id="settings-container" style="display: none;">
                <h3>変換設定</h3>
                <div class="settings-group">
                    <label for="threshold-range">閾値: <span id="threshold-value">128</span></label>
                    <input type="range" id="threshold-range" min="1" max="255" value="128">
                </div>
                <div class="settings-group">
                    <label for="color-mode">カラーモード:</label>
                    <select id="color-mode">
                        <option value="color">カラー</option>
                        <option value="bw">白黒</option>
                    </select>
                </div>
                <div class="settings-group">
                    <label for="simplify-range">単純化: <span id="simplify-value">0.5</span></label>
                    <input type="range" id="simplify-range" min="0" max="1" step="0.1" value="0.5">
                </div>
            </div>

            <div class="preview-container" id="preview-container" style="display: none;">
                <div class="preview-section">
                    <h3>元の画像</h3>
                    <div class="image-preview">
                        <img id="original-image" src="" alt="元の画像">
                    </div>
                </div>
                
                <div class="preview-section">
                    <h3>SVG変換プレビュー</h3>
                    <div class="svg-preview" id="svg-preview">
                        <!-- SVGがここに表示されます -->
                    </div>
                </div>
            </div>

            <div class="progress-container" id="progress-container" style="display: none;">
                <div class="progress-bar">
                    <div class="progress" id="progress-bar"></div>
                </div>
                <p id="progress-text">変換中... 0%</p>
            </div>

            <div class="control-panel" id="control-panel" style="display: none;">
                <button id="convert-btn" class="convert-button">変換実行</button>
                <button id="download-btn" class="download-button">SVGをダウンロード</button>
                <button id="reset-btn" class="reset-button">リセット</button>
                <details>
                    <summary>SVGコード</summary>
                    <pre id="svg-code" class="svg-code"></pre>
                </details>
            </div>
        </main>

        <footer>
            <p>© 2025 画像SVG変換ツール - プライバシーを考慮した完全クライアントサイド処理</p>
        </footer>
    </div>

    <!-- Potraceライブラリ -->
    <script>
        // Potraceライブラリの読み込み状態を確認するためのフラグ
        window.potraceLoaded = false;
        
        // Potraceライブラリの読み込みが成功した場合の処理
        function potraceLoadSuccess() {
            console.log('Potraceライブラリの読み込みが成功しました');
            window.potraceLoaded = true;
        }
        
        // Potraceライブラリの読み込みが失敗した場合の処理
        function potraceLoadError() {
            console.warn('Potraceライブラリの読み込みに失敗しました。代替処理が使用されます。');
        }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/potrace@2.1.8/potrace.min.js" 
            onload="potraceLoadSuccess()" 
            onerror="potraceLoadError()"></script>
    <script src="imagetracer.js"></script>
    <script src="app.js"></script>
</body>
</html>
